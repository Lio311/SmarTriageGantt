name: Daily Gantt Task Report

on:
  schedule:
    # מריץ כל יום ב-8:00 בבוקר (זמן UTC)
    - cron: '0 8 * * *'
  # מאפשר הרצה ידנית
  workflow_dispatch:

jobs:
  build-and-send-report:
    runs-on: ubuntu-latest
    
    steps:
      # 1. מוריד את קוד הריפוזיטורי
      - name: Check out repository
        uses: actions/checkout@v4

      # 2. מגדיר סביבת פייתון
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      # 3. מתקין את התלויות
      - name: Install dependencies
        run: pip install pandas openpyxl # <--- הוספנו openpyxl

      # 4. מריץ את סקריפט הפייתון
      - name: Run Python script to send email
        env:
          GMAIL_USER: ${{ secrets.GMAIL_USER }}
          GMAIL_PASS: ${{ secrets.GMAIL_PASS }}
          RECIPIENT_EMAIL: ${{ secrets.RECIPIENT_EMAIL }}
        run: python send_gantt_summary.py
